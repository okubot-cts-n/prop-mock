<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>統合言語学習ナビゲーション v3.0</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Hiragino Sans', 'Yu Gothic UI', sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .screen {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            margin: 20px 0;
            display: none;
            animation: slideIn 0.5s ease-out;
        }
        
        .screen.active {
            display: block;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .logo {
            color: #2c3e50;
            font-size: 36px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #666;
            font-size: 18px;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
            margin: 20px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transition: width 0.5s ease;
        }
        
        /* 主要選択カード */
        .main-selection-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin: 50px 0;
        }
        
        .main-card {
            background: white;
            border: 3px solid #e9ecef;
            border-radius: 20px;
            padding: 40px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            min-height: 250px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .main-card:hover {
            border-color: #667eea;
            transform: translateY(-8px);
            box-shadow: 0 12px 35px rgba(102, 126, 234, 0.3);
        }
        
        .main-card.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .main-card-icon {
            font-size: 64px;
            margin-bottom: 20px;
        }
        
        .main-card-title {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 15px;
        }
        
        .main-card-description {
            font-size: 16px;
            line-height: 1.5;
            opacity: 0.8;
        }
        
        /* 英語アプローチ選択 */
        .approach-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin: 40px 0;
        }
        
        .approach-card {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 16px;
            padding: 35px;
            cursor: pointer;
            transition: all 0.3s;
            min-height: 300px;
        }
        
        .approach-card:hover {
            border-color: #667eea;
            background: white;
            transform: translateY(-3px);
        }
        
        .approach-card.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .approach-icon {
            font-size: 48px;
            margin-bottom: 20px;
        }
        
        .approach-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 15px;
        }
        
        .approach-description {
            font-size: 16px;
            line-height: 1.6;
            margin-bottom: 20px;
        }
        
        .approach-features {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .feature-tag {
            background: rgba(255,255,255,0.2);
            color: inherit;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .approach-card:not(.selected) .feature-tag {
            background: #e3f2fd;
            color: #1976d2;
        }
        
        /* TOEIC レベル選択 */
        .toeic-level-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 40px 0;
        }
        
        .toeic-level-card {
            background: white;
            border: 2px solid #dee2e6;
            border-radius: 12px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .toeic-level-card:hover {
            border-color: #667eea;
            background: #f8f9ff;
        }
        
        .toeic-level-card.selected {
            border-color: #667eea;
            background: #667eea;
            color: white;
        }
        
        .toeic-score {
            font-size: 22px;
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .toeic-description {
            font-size: 14px;
            opacity: 0.8;
        }
        
        /* 言語選択 */
        .language-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 40px 0;
        }
        
        .language-card {
            background: white;
            border: 2px solid #dee2e6;
            border-radius: 12px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .language-card:hover {
            border-color: #667eea;
            background: #f8f9ff;
        }
        
        .language-card.selected {
            border-color: #667eea;
            background: #667eea;
            color: white;
        }
        
        .language-flag {
            font-size: 48px;
            margin-bottom: 10px;
        }
        
        .language-name {
            font-size: 18px;
            font-weight: bold;
        }
        
        /* 課題選択（会話実践） */
        .skill-grid {
            display: grid;
            grid-template-columns: 100px 1fr;
            gap: 20px;
            margin: 30px 0;
        }
        
        .skill-row {
            display: contents;
        }
        
        .skill-label {
            display: flex;
            align-items: center;
            font-weight: bold;
            color: #495057;
        }
        
        .skill-icon {
            margin-right: 8px;
            font-size: 20px;
        }
        
        .difficulty-options {
            display: flex;
            gap: 10px;
            align-items: flex-start;
        }
        
        .difficulty-btn {
            flex: 1;
            padding: 15px;
            border: 2px solid #dee2e6;
            border-radius: 12px;
            background: white;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            font-size: 14px;
        }
        
        .difficulty-btn:hover {
            border-color: #667eea;
            background: #f8f9ff;
        }
        
        .difficulty-btn.selected {
            border-color: #667eea !important;
            background: #667eea !important;
            color: white !important;
            transform: scale(1.02);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }
        
        /* 課題選択（TOEIC） */
        .toeic-challenge-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 40px 0;
        }
        
        .toeic-challenge-card {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 12px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .toeic-challenge-card:hover {
            border-color: #667eea;
            background: white;
        }
        
        .toeic-challenge-card.selected {
            border-color: #667eea;
            background: #667eea;
            color: white;
        }
        
        .challenge-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .challenge-description {
            font-size: 14px;
            line-height: 1.5;
        }
        
        /* ツールタイプ選択 */
        .tool-type-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 40px 0;
        }
        
        .tool-type-card {
            background: white;
            border: 2px solid #dee2e6;
            border-radius: 12px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .tool-type-card:hover {
            border-color: #667eea;
            background: #f8f9ff;
        }
        
        .tool-type-card.selected {
            border-color: #667eea;
            background: #667eea;
            color: white;
        }
        
        .tool-icon {
            font-size: 36px;
            margin-bottom: 15px;
        }
        
        .tool-name {
            font-size: 16px;
            font-weight: bold;
        }
        
        /* サービス表示 */
        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }
        
        .service-card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 16px;
            padding: 25px;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .service-card:hover {
            border-color: #667eea;
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        
        .service-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .service-logo {
            font-size: 32px;
        }
        
        .service-info {
            flex: 1;
        }
        
        .service-name {
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 5px;
            color: #2c3e50;
        }
        
        .service-price {
            color: #667eea;
            font-weight: bold;
            font-size: 16px;
        }
        
        .service-description {
            color: #666;
            font-size: 14px;
            margin-bottom: 15px;
            line-height: 1.5;
        }
        
        .service-features {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-bottom: 15px;
        }
        
        .service-features .feature-tag {
            background: #e3f2fd;
            color: #1976d2;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
        }
        
        .learning-advice {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
        }
        
        .advice-title {
            font-weight: bold;
            color: #495057;
            margin-bottom: 8px;
            font-size: 14px;
        }
        
        .advice-content {
            font-size: 13px;
            color: #666;
            line-height: 1.4;
        }
        
        /* ボタン */
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            margin: 10px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }
        
        .btn-primary:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-secondary {
            background: #e9ecef;
            color: #495057;
        }
        
        .btn-secondary:hover {
            background: #dee2e6;
        }
        
        .btn-container {
            text-align: center;
            margin-top: 40px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 画面1: 言語種類選択 -->
        <div class="screen active" id="language-type-selection">
            <div class="header">
                <div class="logo">🌐 統合言語学習ナビ</div>
                <div class="subtitle">学習したい言語の種類を選択してください</div>
            </div>
            
            <div class="main-selection-grid">
                <div class="main-card" onclick="selectLanguageType('english')">
                    <div class="main-card-icon">🇬🇧</div>
                    <div class="main-card-title">英語</div>
                    <div class="main-card-description">
                        基礎重視・TOEIC対策または会話・実践重視の<br>
                        2つのアプローチから選択できます
                    </div>
                </div>
                <div class="main-card" onclick="selectLanguageType('multilingual')">
                    <div class="main-card-icon">🌍</div>
                    <div class="main-card-title">多言語</div>
                    <div class="main-card-description">
                        中国語、ドイツ語、フランス語、タイ語、<br>
                        ベトナム語、韓国語から選択できます
                    </div>
                </div>
            </div>
            
            <div class="btn-container">
                <button class="btn btn-primary" id="language-type-next" onclick="proceedFromLanguageType()" disabled>次へ進む</button>
            </div>
        </div>
        
        <!-- 画面2A: 英語アプローチ選択 -->
        <div class="screen" id="english-approach-selection">
            <div class="header">
                <div class="logo">英語学習アプローチ</div>
                <div class="subtitle">あなたの学習目標に合ったアプローチを選択してください</div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 25%"></div>
                </div>
            </div>
            
            <div class="approach-grid">
                <div class="approach-card" onclick="selectEnglishApproach('toeic-focused')">
                    <div class="approach-icon">📚</div>
                    <div class="approach-title">基礎重視・TOEIC対策</div>
                    <div class="approach-description">
                        文法や語彙の基礎固めを重視し、TOEIC スコアアップを目指します。
                        体系的な学習でしっかりとした英語力を身につけたい方におすすめです。
                    </div>
                    <div class="approach-features">
                        <span class="feature-tag">TOEIC対策</span>
                        <span class="feature-tag">基礎文法</span>
                        <span class="feature-tag">語彙強化</span>
                        <span class="feature-tag">問題演習</span>
                    </div>
                </div>
                <div class="approach-card" onclick="selectEnglishApproach('conversation-focused')">
                    <div class="approach-icon">🗣️</div>
                    <div class="approach-title">会話・実践重視</div>
                    <div class="approach-description">
                        実際の会話やコミュニケーション能力を重視した学習です。
                        音声・文章・語彙の実践的なスキル向上を目指したい方におすすめです。
                    </div>
                    <div class="approach-features">
                        <span class="feature-tag">会話練習</span>
                        <span class="feature-tag">発音矯正</span>
                        <span class="feature-tag">実践的表現</span>
                        <span class="feature-tag">コミュニケーション</span>
                    </div>
                </div>
            </div>
            
            <div class="btn-container">
                <button class="btn btn-secondary" onclick="goBack('language-type-selection')">戻る</button>
                <button class="btn btn-primary" id="english-approach-next" onclick="proceedFromEnglishApproach()" disabled>次へ進む</button>
            </div>
        </div>
        
        <!-- 画面3A-1: TOEIC レベル選択 -->
        <div class="screen" id="toeic-level-selection">
            <div class="header">
                <div class="logo">TOEIC レベル診断</div>
                <div class="subtitle">現在のTOEICレベルを選択してください</div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 50%"></div>
                </div>
            </div>
            
            <div class="toeic-level-grid">
                <div class="toeic-level-card" onclick="selectToeicLevel('under-450')">
                    <div class="toeic-score">〜450点</div>
                    <div class="toeic-description">基礎から始めるレベル</div>
                </div>
                <div class="toeic-level-card" onclick="selectToeicLevel('451-600')">
                    <div class="toeic-score">451〜600点</div>
                    <div class="toeic-description">基礎固めレベル</div>
                </div>
                <div class="toeic-level-card" onclick="selectToeicLevel('601-730')">
                    <div class="toeic-score">601〜730点</div>
                    <div class="toeic-description">中級レベル</div>
                </div>
                <div class="toeic-level-card" onclick="selectToeicLevel('730-plus')">
                    <div class="toeic-score">730点〜</div>
                    <div class="toeic-description">上級レベル</div>
                </div>
            </div>
            
            <div class="btn-container">
                <button class="btn btn-secondary" onclick="goBack('english-approach-selection')">戻る</button>
                <button class="btn btn-primary" id="toeic-level-next" onclick="nextScreen('toeic-challenge-selection')" disabled>次へ進む</button>
            </div>
        </div>
        
        <!-- 画面4A-1: TOEIC 課題選択 -->
        <div class="screen" id="toeic-challenge-selection">
            <div class="header">
                <div class="logo">学習課題の選択</div>
                <div class="subtitle">現在の課題として当てはまるものを選択してください（複数選択可）</div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 75%"></div>
                </div>
            </div>
            
            <div class="toeic-challenge-grid" id="toeic-challenges-container">
                <!-- 課題は動的に生成 -->
            </div>
            
            <div class="btn-container">
                <button class="btn btn-secondary" onclick="goBack('toeic-level-selection')">戻る</button>
                <button class="btn btn-primary" id="toeic-challenge-next" onclick="nextScreen('tool-type-selection')" disabled>次へ進む</button>
            </div>
        </div>
        
        <!-- 画面5A-1: ツールタイプ選択 -->
        <div class="screen" id="tool-type-selection">
            <div class="header">
                <div class="logo">学習スタイルの選択</div>
                <div class="subtitle">ご希望の学習スタイルを選択してください</div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 90%"></div>
                </div>
            </div>
            
            <div class="tool-type-grid">
                <div class="tool-type-card" onclick="selectToolType('app')">
                    <div class="tool-icon">📱</div>
                    <div class="tool-name">アプリ</div>
                </div>
                <div class="tool-type-card" onclick="selectToolType('lesson')">
                    <div class="tool-icon">👨‍🏫</div>
                    <div class="tool-name">レッスン</div>
                </div>
                <div class="tool-type-card" onclick="selectToolType('coaching')">
                    <div class="tool-icon">🎯</div>
                    <div class="tool-name">コーチング</div>
                </div>
            </div>
            
            <div class="btn-container">
                <button class="btn btn-secondary" onclick="goBack('toeic-challenge-selection')">戻る</button>
                <button class="btn btn-primary" id="tool-type-next" onclick="showResults()" disabled>結果を見る</button>
            </div>
        </div>
        
        <!-- 画面3A-2: 会話実践スキル診断 -->
        <div class="screen" id="conversation-skill-diagnosis">
            <div class="header">
                <div class="logo">スキル診断</div>
                <div class="subtitle">現在の英語スキルについて教えてください</div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 50%"></div>
                </div>
            </div>
            
            <div class="skill-grid">
                <div class="skill-label">
                    <span class="skill-icon">🎧</span> 音声
                </div>
                <div class="difficulty-options">
                    <div class="difficulty-btn" onclick="selectConversationSkill(this, 'sound', 'basic')">
                        基本的なルールが<br>わからない
                    </div>
                    <div class="difficulty-btn" onclick="selectConversationSkill(this, 'sound', 'intermediate')">
                        音が聞き分けられない<br>音が回らない
                    </div>
                    <div class="difficulty-btn" onclick="selectConversationSkill(this, 'sound', 'advanced')">
                        スピードについていけない<br>長くなると保持できない
                    </div>
                </div>
                
                <div class="skill-label">
                    <span class="skill-icon">📝</span> 文章
                </div>
                <div class="difficulty-options">
                    <div class="difficulty-btn" onclick="selectConversationSkill(this, 'text', 'basic')">
                        基本的な文のルール<br>（文法）がわからない
                    </div>
                    <div class="difficulty-btn" onclick="selectConversationSkill(this, 'text', 'intermediate')">
                        文章で理解できない<br>文を組み立てられない
                    </div>
                    <div class="difficulty-btn" onclick="selectConversationSkill(this, 'text', 'advanced')">
                        情報量が多くなると<br>理解できない/話せない
                    </div>
                </div>
                
                <div class="skill-label">
                    <span class="skill-icon">📖</span> 語彙
                </div>
                <div class="difficulty-options">
                    <div class="difficulty-btn" onclick="selectConversationSkill(this, 'vocabulary', 'basic')">
                        基本的な単語が<br>わからない
                    </div>
                    <div class="difficulty-btn" onclick="selectConversationSkill(this, 'vocabulary', 'intermediate')">
                        とっさに簡単な<br>単語が出てこない
                    </div>
                    <div class="difficulty-btn" onclick="selectConversationSkill(this, 'vocabulary', 'advanced')">
                        文脈に応じた表現の<br>使い分けができない
                    </div>
                </div>
            </div>
            
            <div class="btn-container">
                <button class="btn btn-secondary" onclick="goBack('english-approach-selection')">戻る</button>
                <button class="btn btn-primary" id="conversation-skill-next" onclick="showResults()" disabled>結果を見る</button>
            </div>
        </div>
        
        <!-- 画面2B: 多言語選択 -->
        <div class="screen" id="multilingual-selection">
            <div class="header">
                <div class="logo">言語選択</div>
                <div class="subtitle">学習したい言語を選択してください</div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 50%"></div>
                </div>
            </div>
            
            <div class="language-grid">
                <div class="language-card" onclick="selectMultilanguage('中国語')">
                    <div class="language-flag">🇨🇳</div>
                    <div class="language-name">中国語</div>
                </div>
                <div class="language-card" onclick="selectMultilanguage('ドイツ語')">
                    <div class="language-flag">🇩🇪</div>
                    <div class="language-name">ドイツ語</div>
                </div>
                <div class="language-card" onclick="selectMultilanguage('フランス語')">
                    <div class="language-flag">🇫🇷</div>
                    <div class="language-name">フランス語</div>
                </div>
                <div class="language-card" onclick="selectMultilanguage('タイ語')">
                    <div class="language-flag">🇹🇭</div>
                    <div class="language-name">タイ語</div>
                </div>
                <div class="language-card" onclick="selectMultilanguage('ベトナム語')">
                    <div class="language-flag">🇻🇳</div>
                    <div class="language-name">ベトナム語</div>
                </div>
                <div class="language-card" onclick="selectMultilanguage('韓国語')">
                    <div class="language-flag">🇰🇷</div>
                    <div class="language-name">韓国語</div>
                </div>
            </div>
            
            <div class="btn-container">
                <button class="btn btn-secondary" onclick="goBack('language-type-selection')">戻る</button>
                <button class="btn btn-primary" id="multilingual-next" onclick="showResults()" disabled>サービスを見る</button>
            </div>
        </div>
        
        <!-- 画面6: 結果表示 -->
        <div class="screen" id="results">
            <div class="header">
                <div class="logo">おすすめサービス</div>
                <div class="subtitle" id="results-subtitle">あなたにぴったりの学習サービスをご提案</div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 100%"></div>
                </div>
            </div>
            
            <div class="services-grid" id="services-container">
                <!-- サービスは動的に生成 -->
            </div>
            
            <div class="btn-container">
                <button class="btn btn-secondary" onclick="resetAll()">最初からやり直す</button>
            </div>
        </div>
    </div>
    
    <script>
        // ユーザーの選択を保存
        let userSelections = {
            languageType: null,          // 'english' or 'multilingual'
            englishApproach: null,       // 'toeic-focused' or 'conversation-focused'
            toeicLevel: null,           // 'under-450', '451-600', '601-730', '730-plus'
            toeicChallenges: [],        // 複数選択可能
            toolType: null,             // 'app', 'lesson', 'coaching'
            conversationSkills: {},     // {skill_level: true}
            selectedLanguage: null       // 多言語の場合の選択言語
        };
        
        // CSVデータを保存する変数
        let servicesData = [];
        
        // CSVデータの読み込み（実装時はファイルから読み込み）
        const csvData = `サービスID,サービス名,カテゴリ,サブカテゴリ,ツールタイプ,価格,公式URL,対応TOEICレベル,対応課題_基礎重視,対応課題_会話実践,学習の流れ,推奨スケジュール,推奨学習時間,学習のポイント,特徴タグ,学習スタイル,対応言語
EN_TOEIC_001,スタディサプリ ENGLISH TOEIC,英語基礎重視,TOEIC対策,アプリ,月額3278円,https://eigosapuri.jp/,〜450点・451〜600点・601〜730点,基礎ルール・問題傾向・長文対策,,1.基礎文法の復習→2.頻出単語の暗記→3.模擬問題演習→4.弱点強化,毎日30分×3ヶ月,1日30分,隙間時間を有効活用・継続が重要,スマホ学習・AI学習・進捗管理,自主学習,英語
EN_TOEIC_002,abceed,英語基礎重視,TOEIC対策,アプリ,月額1650円,https://www.abceed.com/,〜450点・451〜600点・601〜730点,基礎ルール・問題傾向・長文対策,,1.レベル診断→2.AI推奨問題→3.弱点分析→4.集中学習,毎日25分×4ヶ月,1日25分,AI予測スコアで目標設定・豊富な問題集活用,AI予測スコア・豊富な問題集・学習分析,自主学習,英語
EN_TOEIC_003,TOEIC完全攻略講座,英語基礎重視,TOEIC対策,レッスン,月額8800円,https://example-toeic.com/,451〜600点・601〜730点・730点〜,問題傾向・長文対策・スピード正確性,,1.診断テスト→2.パート別対策→3.模擬テスト→4.総合演習,週2回×6ヶ月,週150分,講師による個別指導・実践的な解答技術,講師指導・パート別対策・模擬テスト,講師指導,英語
EN_TOEIC_004,PROGRIT TOEIC,英語基礎重視,TOEIC対策,コーチング,3ヶ月599500円,https://www.progrit.co.jp/,601〜730点・730点〜,長文対策・スピード正確性・リーディング対策,,1.現状分析→2.個別カリキュラム→3.毎日学習→4.週次面談,毎日3時間×3ヶ月,1日180分,専属コンサルタント・短期集中・科学的アプローチ,短期集中・専属コンサルタント・科学的学習,コーチング,英語
EN_CONV_001,DMM英会話,英語会話実践重視,会話練習,レッスン,月額6480円,https://eikaiwa.dmm.com/,300-600・600-750,音声基礎・音声中級・文章基礎・文章中級,音声基礎・音声中級・文章基礎・文章中級,1.基礎会話→2.トピック練習→3.フリートーク→4.実践会話,毎日25分×継続,1日25分,多国籍講師・24時間対応・豊富な教材,多国籍講師・24時間対応・豊富な教材,講師指導,英語
EN_CONV_002,Native Camp,英語会話実践重視,会話練習,レッスン,月額6480円,https://nativecamp.net/,300-600・600-750・750+,音声基礎・音声中級・音声上級・文章基礎・文章中級・文章上級,音声基礎・音声中級・音声上級・文章基礎・文章中級・文章上級,1.レベルチェック→2.基礎練習→3.実践会話→4.応用練習,レッスン受け放題×継続,無制限,予約不要・カランメソッド対応・豊富なコンテンツ,予約不要・カランメソッド・レッスン受け放題,自習型,英語
EN_CONV_003,SHADOTEN,英語会話実践重視,発音矯正,添削サービス,月額21780円,https://www.shadoten.com/,600-750・750+,音声中級・音声上級,音声中級・音声上級,1.シャドーイング基礎→2.音声分析→3.プロ添削→4.実践練習,毎日30分×3ヶ月,1日30分,プロ添削・音声分析・集中トレーニング,プロ添削・音声分析・シャドーイング特化,自習型,英語
EN_CONV_004,Cambly,英語会話実践重視,会話練習,レッスン,月額12790円,https://www.cambly.com/,600-750・750+,音声中級・音声上級・文章中級・文章上級・語彙中級・語彙上級,音声中級・音声上級・文章中級・文章上級・語彙中級・語彙上級,1.ネイティブ会話→2.発音練習→3.表現力強化→4.実践応用,週3回×継続,週90分,ネイティブ講師・録画機能・柔軟スケジュール,ネイティブ講師・録画機能・柔軟予約,講師指導,英語
CN_001,超速中国語,多言語,中国語,アプリ,月額1980円,https://chousoku-chinese.com/,,,音声基礎・音声中級・文章基礎・語彙基礎・語彙中級,1.ピンイン学習→2.基本単語→3.基本文法→4.会話練習,毎日20分×6ヶ月,1日20分,ゲーム感覚・効率的記憶・段階的学習,ゲーム感覚・効率学習・音声認識,自主学習,中国語
CN_002,天天中文,多言語,中国語,レッスン,月額7800円,https://tentenchugoku.com/,,,音声基礎・音声中級・文章基礎・文章中級・語彙基礎・語彙中級,1.発音基礎→2.基本会話→3.文法学習→4.実践練習,週2回×継続,週100分,ネイティブ講師・実践的会話・文化理解,ネイティブ講師・実践会話・文化学習,講師指導,中国語
CN_003,CC Lesson,多言語,中国語,レッスン,月額9790円,https://www.cclesson.com/,,,音声中級・音声上級・文章中級・文章上級・語彙中級・語彙上級,1.レベル診断→2.個別カリキュラム→3.マンツーマン指導→4.実践応用,週2回×継続,週120分,マンツーマン・ビジネス中国語・検定対策,マンツーマン・ビジネス特化・検定対策,講師指導,中国語
CN_004,BIZ China,多言語,中国語,スクール,月額15000円,https://bizchina-school.com/,,,音声上級・文章上級・語彙上級,1.ビジネス基礎→2.商談練習→3.文書作成→4.実務応用,週1回×継続,週120分,ビジネス特化・実務経験・企業研修,ビジネス特化・実務重視・企業研修対応,講師指導,中国語
DE_001,ドイツ語マスター,多言語,ドイツ語,アプリ,月額1800円,https://deutsch-master.com/,,,音声基礎・文章基礎・語彙基礎,1.アルファベット→2.基本単語→3.基本文法→4.会話練習,毎日25分×6ヶ月,1日25分,音声認識・文法解説・段階学習,音声認識・文法特化・進捗管理,自主学習,ドイツ語
DE_002,ドイツ語オンライン,多言語,ドイツ語,レッスン,月額8500円,https://deutsch-online.com/,,,音声基礎・音声中級・文章基礎・文章中級・語彙基礎・語彙中級,1.発音練習→2.基本会話→3.文法学習→4.実践対話,週2回×継続,週100分,ネイティブ講師・実践会話・文化紹介,ネイティブ講師・実践重視・文化学習,講師指導,ドイツ語
DE_003,ゲーテ・インスティトゥート,多言語,ドイツ語,スクール,月額20000円,https://www.goethe.de/,,,音声中級・音声上級・文章中級・文章上級・語彙中級・語彙上級,1.レベル診断→2.体系的学習→3.検定準備→4.資格取得,週2回×継続,週200分,公式機関・資格対策・本格指導,公式機関・資格取得・本格カリキュラム,講師指導,ドイツ語
FR_001,フランス語アプリPlus,多言語,フランス語,アプリ,月額1680円,https://francais-plus.com/,,,音声基礎・文章基礎・語彙基礎,1.発音基礎→2.基本単語→3.基本文法→4.会話練習,毎日20分×6ヶ月,1日20分,音声認識・美しい発音・段階学習,音声認識・発音重視・段階学習,自主学習,フランス語
FR_002,フランス語オンラインレッスン,多言語,フランス語,レッスン,月額7500円,https://francais-lesson.com/,,,音声基礎・音声中級・文章基礎・文章中級・語彙基礎・語彙中級,1.発音指導→2.基本会話→3.文法学習→4.文化理解,週2回×継続,週100分,ネイティブ講師・文化紹介・実践会話,ネイティブ講師・文化重視・実践会話,講師指導,フランス語
FR_003,Alliance Française,多言語,フランス語,スクール,月額18000円,https://www.alliancefr.org/,,,音声中級・音声上級・文章中級・文章上級・語彙中級・語彙上級,1.体系的学習→2.検定対策→3.文化理解→4.実践応用,週2回×継続,週180分,政府認定・本格指導・検定対策,政府認定・本格カリキュラム・検定対策,講師指導,フランス語
TH_001,タイ語学習アプリ,多言語,タイ語,アプリ,月額1200円,https://thai-learning.com/,,,音声基礎・文章基礎・語彙基礎,1.文字学習→2.基本単語→3.会話練習→4.実践応用,毎日30分×6ヶ月,1日30分,文字学習・音調練習・実用会話,文字重視・音調練習・実用性,自主学習,タイ語
TH_002,タイ語オンライン教室,多言語,タイ語,レッスン,月額6800円,https://thai-online-class.com/,,,音声基礎・音声中級・文章基礎・文章中級・語彙基礎・語彙中級,1.基礎発音→2.日常会話→3.文法学習→4.実践会話,週2回×継続,週120分,ネイティブ講師・実践会話・文化理解,ネイティブ講師・実践重視・文化学習,講師指導,タイ語
TH_003,バンコク語学スクール,多言語,タイ語,スクール,月額12000円,https://bangkok-language.com/,,,音声中級・音声上級・文章中級・文章上級・語彙中級・語彙上級,1.集中基礎→2.実践練習→3.ビジネス応用→4.検定対策,週1回×継続,週150分,集中指導・ビジネス対応・検定対策,集中指導・ビジネス特化・検定対応,講師指導,タイ語
VN_001,ベトナム語マスター,多言語,ベトナム語,アプリ,月額1400円,https://vietnamese-master.com/,,,音声基礎・文章基礎・語彙基礎,1.声調学習→2.基本単語→3.基本文法→4.会話練習,毎日25分×6ヶ月,1日25分,声調練習・段階学習・実用重視,声調重視・段階学習・実用性,自主学習,ベトナム語
VN_002,ベトナム語会話レッスン,多言語,ベトナム語,レッスン,月額5800円,https://vietnamese-lesson.com/,,,音声基礎・音声中級・文章基礎・文章中級・語彙基礎・語彙中級,1.発音指導→2.日常会話→3.文法学習→4.実践練習,週2回×継続,週100分,ネイティブ講師・実践会話・ビジネス対応,ネイティブ講師・実践重視・ビジネス対応,講師指導,ベトナム語
VN_003,ハノイ語学センター,多言語,ベトナム語,スクール,月額9000円,https://hanoi-center.com/,,,音声中級・音声上級・文章中級・文章上級・語彙中級・語彙上級,1.基礎固め→2.実践練習→3.ビジネス応用→4.文化理解,週1回×継続,週120分,専門指導・ビジネス対応・文化理解,専門指導・ビジネス特化・文化重視,講師指導,ベトナム語
KO_001,韓国語学習アプリPro,多言語,韓国語,アプリ,月額1580円,https://korean-pro.com/,,,音声基礎・文章基礎・語彙基礎,1.ハングル学習→2.基本単語→3.基本文法→4.K-POP活用,毎日20分×6ヶ月,1日20分,ハングル特化・K-POP活用・楽しい学習,ハングル重視・K-POP活用・エンタメ学習,自主学習,韓国語
KO_002,韓国語オンライン教室,多言語,韓国語,レッスン,月額6500円,https://korean-online.com/,,,音声基礎・音声中級・文章基礎・文章中級・語彙基礎・語彙中級,1.発音練習→2.基本会話→3.ドラマ活用→4.実践会話,週2回×継続,週100分,ネイティブ講師・ドラマ活用・文化理解,ネイティブ講師・ドラマ活用・文化学習,講師指導,韓国語
KO_003,ソウル語学院,多言語,韓国語,スクール,月額13500円,https://seoul-academy.com/,,,音声中級・音声上級・文章中級・文章上級・語彙中級・語彙上級,1.体系学習→2.検定対策→3.ビジネス応用→4.文化理解,週2回×継続,週160分,検定対策・ビジネス対応・本格指導,検定対策・ビジネス特化・本格カリキュラム,講師指導,韓国語`;
        
        // 初期化：CSVデータをパース
        function initializeData() {
            const lines = csvData.trim().split('\n');
            const headers = lines[0].split(',');
            
            for (let i = 1; i < lines.length; i++) {
                const values = lines[i].split(',');
                const service = {};
                headers.forEach((header, index) => {
                    service[header] = values[index] || '';
                });
                servicesData.push(service);
            }
        }
        
        // 言語種類選択
        function selectLanguageType(type) {
            // 既存の選択をクリア
            document.querySelectorAll('.main-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // 新しい選択を追加
            event.currentTarget.classList.add('selected');
            userSelections.languageType = type;
            
            // 次へボタンを有効化
            document.getElementById('language-type-next').disabled = false;
        }
        
        // 言語種類選択からの進行
        function proceedFromLanguageType() {
            if (userSelections.languageType === 'english') {
                nextScreen('english-approach-selection');
            } else if (userSelections.languageType === 'multilingual') {
                nextScreen('multilingual-selection');
            }
        }
        
        // 英語アプローチ選択
        function selectEnglishApproach(approach) {
            // 既存の選択をクリア
            document.querySelectorAll('.approach-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // 新しい選択を追加
            event.currentTarget.classList.add('selected');
            userSelections.englishApproach = approach;
            
            // 次へボタンを有効化
            document.getElementById('english-approach-next').disabled = false;
        }
        
        // 英語アプローチ選択からの進行
        function proceedFromEnglishApproach() {
            if (userSelections.englishApproach === 'toeic-focused') {
                nextScreen('toeic-level-selection');
            } else if (userSelections.englishApproach === 'conversation-focused') {
                nextScreen('conversation-skill-diagnosis');
            }
        }
        
        // TOEIC レベル選択
        function selectToeicLevel(level) {
            // 既存の選択をクリア
            document.querySelectorAll('.toeic-level-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // 新しい選択を追加
            event.currentTarget.classList.add('selected');
            userSelections.toeicLevel = level;
            
            // 次へボタンを有効化
            document.getElementById('toeic-level-next').disabled = false;
            
            // TOEICレベルに基づいて課題を生成
            generateToeicChallenges(level);
        }
        
        // TOEIC 課題を動的に生成
        function generateToeicChallenges(level) {
            const challengeDefinitions = {
                'under-450': [
                    { id: 'basic-rules', title: '基礎ルール', description: '英語の基本的なルール（文法・語彙）がわからない' }
                ],
                '451-600': [
                    { id: 'problem-patterns', title: '問題傾向', description: 'TOEICの問題パターンや傾向を身に付ける必要がある' }
                ],
                '601-730': [
                    { id: 'long-reading', title: '長文対策', description: '長文読解にチャレンジする必要がある' }
                ],
                '730-plus': [
                    { id: 'speed-accuracy', title: 'スピード・正確性', description: 'よりスピーディーに正確に問題を解く必要がある' },
                    { id: 'reading-issues', title: 'リーディング対策', description: 'リーディングセクションでつまずくことが多い' }
                ]
            };
            
            const challenges = challengeDefinitions[level] || [];
            const container = document.getElementById('toeic-challenges-container');
            
            container.innerHTML = challenges.map(challenge => `
                <div class="toeic-challenge-card" onclick="selectToeicChallenge('${challenge.id}')">
                    <div class="challenge-title">${challenge.title}</div>
                    <div class="challenge-description">${challenge.description}</div>
                </div>
            `).join('');
        }
        
        // TOEIC 課題選択
        function selectToeicChallenge(challengeId) {
            const card = event.currentTarget;
            
            if (card.classList.contains('selected')) {
                // 選択解除
                card.classList.remove('selected');
                userSelections.toeicChallenges = userSelections.toeicChallenges.filter(id => id !== challengeId);
            } else {
                // 選択追加
                card.classList.add('selected');
                userSelections.toeicChallenges.push(challengeId);
            }
            
            // 次へボタンの有効化判定
            document.getElementById('toeic-challenge-next').disabled = userSelections.toeicChallenges.length === 0;
        }
        
        // ツールタイプ選択
        function selectToolType(type) {
            // 既存の選択をクリア
            document.querySelectorAll('.tool-type-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // 新しい選択を追加
            event.currentTarget.classList.add('selected');
            userSelections.toolType = type;
            
            // 次へボタンを有効化
            document.getElementById('tool-type-next').disabled = false;
        }
        
        // 会話実践スキル選択
        function selectConversationSkill(element, skill, level) {
            const key = skill + '_' + level;
            
            if (element.classList.contains('selected')) {
                // 選択解除
                element.classList.remove('selected');
                delete userSelections.conversationSkills[key];
            } else {
                // 選択追加
                element.classList.add('selected');
                userSelections.conversationSkills[key] = { skill: skill, level: level };
            }
            
            // 次へボタンの有効化判定
            const hasSelection = Object.keys(userSelections.conversationSkills).length > 0;
            document.getElementById('conversation-skill-next').disabled = !hasSelection;
        }
        
        // 多言語選択
        function selectMultilanguage(language) {
            // 既存の選択をクリア
            document.querySelectorAll('.language-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // 新しい選択を追加
            event.currentTarget.classList.add('selected');
            userSelections.selectedLanguage = language;
            
            // 次へボタンを有効化
            document.getElementById('multilingual-next').disabled = false;
        }
        
        // 結果表示
        function showResults() {
            nextScreen('results');
            displayFilteredServices();
        }
        
        // サービスフィルタリングと表示
        function displayFilteredServices() {
            const filteredServices = getFilteredServices();
            const container = document.getElementById('services-container');
            
            if (filteredServices.length === 0) {
                container.innerHTML = '<div style="text-align: center; color: #666; padding: 40px;">該当するサービスが見つかりませんでした</div>';
                return;
            }
            
            container.innerHTML = filteredServices.map(service => {
                const features = service['特徴タグ'] ? service['特徴タグ'].split('・') : [];
                
                return `
                    <div class="service-card" onclick="window.open('${service['公式URL']}', '_blank')">
                        <div class="service-header">
                            <div class="service-logo">🎯</div>
                            <div class="service-info">
                                <div class="service-name">${service['サービス名']}</div>
                                <div class="service-price">${service['価格']}</div>
                            </div>
                        </div>
                        <div class="service-description">
                            ${service['学習のポイント'] || '効果的な学習をサポート'}
                        </div>
                        <div class="service-features">
                            ${features.slice(0, 3).map(feature => `<span class="feature-tag">${feature}</span>`).join('')}
                        </div>
                        ${service['学習の流れ'] ? `
                            <div class="learning-advice">
                                <div class="advice-title">📚 学習の流れ</div>
                                <div class="advice-content">${service['学習の流れ']}</div>
                            </div>
                        ` : ''}
                        ${service['推奨スケジュール'] && service['推奨学習時間'] ? `
                            <div class="learning-advice">
                                <div class="advice-title">⏰ 学習スケジュール</div>
                                <div class="advice-content">${service['推奨スケジュール']} | ${service['推奨学習時間']}</div>
                            </div>
                        ` : ''}
                    </div>
                `;
            }).join('');
            
            // サブタイトルを更新
            updateResultsSubtitle();
        }
        
        // サービスフィルタリング
        function getFilteredServices() {
            if (userSelections.languageType === 'multilingual') {
                // 多言語の場合
                return servicesData.filter(service => 
                    service['対応言語'] === userSelections.selectedLanguage
                );
            } else if (userSelections.languageType === 'english') {
                if (userSelections.englishApproach === 'toeic-focused') {
                    // TOEIC対策の場合
                    return servicesData.filter(service => {
                        const categoryMatch = service['カテゴリ'] === '英語基礎重視';
                        const levelMatch = service['対応TOEICレベル'] && 
                            service['対応TOEICレベル'].includes(getToeicLevelString(userSelections.toeicLevel));
                        const toolMatch = !userSelections.toolType || 
                            service['ツールタイプ'].toLowerCase().includes(userSelections.toolType.toLowerCase());
                        
                        return categoryMatch && levelMatch && toolMatch;
                    });
                } else if (userSelections.englishApproach === 'conversation-focused') {
                    // 会話実践の場合
                    return servicesData.filter(service => {
                        return service['カテゴリ'] === '英語会話実践重視';
                    });
                }
            }
            
            return [];
        }
        
        // TOEIC レベル文字列変換
        function getToeicLevelString(level) {
            const mapping = {
                'under-450': '〜450点',
                '451-600': '451〜600点',
                '601-730': '601〜730点',
                '730-plus': '730点〜'
            };
            return mapping[level] || '';
        }
        
        // 結果サブタイトル更新
        function updateResultsSubtitle() {
            const subtitleElement = document.getElementById('results-subtitle');
            
            if (userSelections.languageType === 'multilingual') {
                subtitleElement.textContent = `${userSelections.selectedLanguage}学習サービス一覧`;
            } else if (userSelections.languageType === 'english') {
                if (userSelections.englishApproach === 'toeic-focused') {
                    subtitleElement.textContent = `英語基礎重視・TOEIC対策 | ${getToeicLevelString(userSelections.toeicLevel)}`;
                } else {
                    subtitleElement.textContent = '英語会話・実践重視サービス';
                }
            }
        }
        
        // 画面遷移
        function nextScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
        }
        
        // 戻る
        function goBack(screenId) {
            nextScreen(screenId);
        }
        
        // 全リセット
        function resetAll() {
            userSelections = {
                languageType: null,
                englishApproach: null,
                toeicLevel: null,
                toeicChallenges: [],
                toolType: null,
                conversationSkills: {},
                selectedLanguage: null
            };
            
            // 選択をクリア
            document.querySelectorAll('.selected').forEach(elem => {
                elem.classList.remove('selected');
            });
            
            // ボタンを無効化
            document.querySelectorAll('.btn-primary').forEach(btn => {
                if (btn.id.includes('next')) {
                    btn.disabled = true;
                }
            });
            
            // 最初の画面に戻る
            nextScreen('language-type-selection');
        }
        
        // 初期化
        document.addEventListener('DOMContentLoaded', function() {
            initializeData();
            console.log('Services data loaded:', servicesData.length, 'services');
        });
    </script>
</body>
</html>